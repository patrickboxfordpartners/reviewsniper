<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Sniper App</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 40 40'><rect width='40' height='40' rx='8' fill='%232563EB'/><circle cx='20' cy='20' r='12' stroke='white' stroke-width='3'/><circle cx='20' cy='20' r='5' fill='white'/></svg>">

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8FAFC; }
        .sidebar-link { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 8px; color: #64748B; font-weight: 500; transition: all 0.2s; cursor: pointer; }
        .sidebar-link:hover { background-color: #F1F5F9; color: #0F172A; }
        .sidebar-link.active { background-color: #EFF6FF; color: #2563EB; }
        .card { background: white; border-radius: 12px; border: 1px solid #E2E8F0; padding: 24px; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- CONFIGURATION ---
        // Replace with your client's Google Maps Review Link
        const GOOGLE_REVIEW_LINK = "https://search.google.com/local/writereview?placeid=YOUR_PLACE_ID"; 

        // --- MOCK DATA ---
        const INTERCEPTED_DATA = [
            { id: 1, name: "Mike Ross", rating: 2, feedback: "Wait time was insane.", date: "2h ago", status: "New" },
            { id: 2, name: "Harvey S.", rating: 3, feedback: "Too expensive.", date: "1d ago", status: "Read" },
            { id: 3, name: "Louis L.", rating: 1, feedback: "Rude staff.", date: "2d ago", status: "Replied" },
        ];

        // ==========================================
        // PART 1: THE CUSTOMER FUNNEL (Gatekeeper)
        // ==========================================
        const FeedbackFlow = () => {
            const [step, setStep] = useState('rate'); // rate, redirect, form, success
            const [rating, setRating] = useState(0);

            const handleRate = (stars) => {
                setRating(stars);
                if (stars >= 4) {
                    setStep('redirect');
                    // In a real app, this would redirect. For demo, we show a message.
                    setTimeout(() => {
                        window.location.href = GOOGLE_REVIEW_LINK;
                    }, 1500);
                } else {
                    setStep('form');
                }
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-4 bg-slate-50">
                    <div className="bg-white p-8 rounded-2xl shadow-xl max-w-md w-full text-center fade-in">
                        
                        {/* STEP 1: RATING */}
                        {step === 'rate' && (
                            <>
                                <div className="w-16 h-16 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-6 text-2xl">
                                    <i className="fa-solid fa-thumbs-up"></i>
                                </div>
                                <h1 className="text-2xl font-bold text-slate-900 mb-2">How was your visit?</h1>
                                <p className="text-slate-500 mb-8">Please rate your experience to continue.</p>
                                <div className="flex justify-center gap-3 mb-6">
                                    {[1, 2, 3, 4, 5].map((star) => (
                                        <button key={star} onClick={() => handleRate(star)} className="text-4xl text-slate-200 hover:text-yellow-400 transition-colors transform hover:scale-110 focus:outline-none">
                                            <i className="fa-solid fa-star"></i>
                                        </button>
                                    ))}
                                </div>
                            </>
                        )}

                        {/* STEP 2: REDIRECT (4-5 Stars) */}
                        {step === 'redirect' && (
                            <div className="py-8">
                                <div className="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6 animate-bounce">
                                    <i className="fa-brands fa-google text-2xl"></i>
                                </div>
                                <h2 className="text-xl font-bold text-slate-900">Awesome!</h2>
                                <p className="text-slate-500 mt-2">Taking you to Google to leave a review...</p>
                            </div>
                        )}

                        {/* STEP 3: FEEDBACK FORM (1-3 Stars) */}
                        {step === 'form' && (
                            <>
                                <div className="w-16 h-16 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mx-auto mb-6 text-2xl">
                                    <i className="fa-solid fa-comment-dots"></i>
                                </div>
                                <h2 className="text-xl font-bold text-slate-900 mb-2">How can we improve?</h2>
                                <p className="text-slate-500 mb-6 text-sm">We're sorry we missed the mark. Please tell us directly so we can make it right.</p>
                                <textarea className="w-full p-4 border border-slate-200 rounded-xl mb-4 focus:ring-2 focus:ring-blue-500 outline-none h-32 text-sm" placeholder="Tell us what happened..."></textarea>
                                <button onClick={() => setStep('success')} className="w-full bg-slate-900 text-white font-bold py-3 rounded-xl hover:bg-slate-800 transition-colors">Send Private Feedback</button>
                            </>
                        )}

                        {/* STEP 4: SUCCESS */}
                        {step === 'success' && (
                            <div className="py-8">
                                <div className="w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-6">
                                    <i className="fa-solid fa-check text-2xl"></i>
                                </div>
                                <h2 className="text-xl font-bold text-slate-900">Thank You</h2>
                                <p className="text-slate-500 mt-2">Your feedback has been sent to management.</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // ==========================================
        // PART 2: THE BUSINESS DASHBOARD
        // ==========================================
        const DashboardApp = () => {
            const [tab, setTab] = useState('overview');
            const qrRef = useRef(null);

            // QR Code Generation
            useEffect(() => {
                if (tab === 'qr' && qrRef.current) {
                    qrRef.current.innerHTML = "";
                    new QRCode(qrRef.current, {
                        text: window.location.href.split('#')[0] + "#feedback", // Links to the feedback view
                        width: 200,
                        height: 200
                    });
                }
            }, [tab]);

            return (
                <div className="min-h-screen flex bg-slate-50 font-sans">
                    {/* Sidebar */}
                    <div className="w-64 bg-white border-r border-slate-200 fixed h-full z-10 hidden md:flex flex-col">
                        <div className="p-6 border-b border-slate-100 flex items-center gap-3">
                            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white"><i className="fa-solid fa-crosshairs"></i></div>
                            <span className="font-bold text-lg text-slate-900">ReviewSniper</span>
                        </div>
                        <nav className="flex-1 p-4 space-y-1">
                            <div onClick={() => setTab('overview')} className={`sidebar-link ${tab === 'overview' ? 'active' : ''}`}><i className="fa-solid fa-chart-pie w-5"></i> Overview</div>
                            <div onClick={() => setTab('inbox')} className={`sidebar-link ${tab === 'inbox' ? 'active' : ''}`}><i className="fa-solid fa-inbox w-5"></i> Intercepted</div>
                            <div onClick={() => setTab('qr')} className={`sidebar-link ${tab === 'qr' ? 'active' : ''}`}><i className="fa-solid fa-qrcode w-5"></i> QR Code</div>
                        </nav>
                        <div className="p-4 border-t border-slate-100">
                             <div className="flex items-center gap-3">
                                <div className="w-8 h-8 bg-slate-200 rounded-full"></div>
                                <div><p className="text-sm font-bold">Demo User</p><p className="text-xs text-slate-500">Pro Plan</p></div>
                             </div>
                        </div>
                    </div>

                    {/* Main Content */}
                    <main className="flex-1 md:ml-64 p-8">
                        
                        {/* OVERVIEW TAB */}
                        {tab === 'overview' && (
                            <div className="fade-in space-y-6">
                                <h1 className="text-2xl font-bold text-slate-900">Dashboard</h1>
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                    <div className="card border-l-4 border-l-green-500">
                                        <p className="text-slate-500 text-sm font-medium">Pushed to Google</p>
                                        <h3 className="text-3xl font-bold text-slate-900 mt-1">142</h3>
                                        <p className="text-xs text-green-600 font-bold mt-2"><i className="fa-solid fa-arrow-up"></i> 4 & 5 Star Reviews</p>
                                    </div>
                                    <div className="card border-l-4 border-l-red-500">
                                        <p className="text-slate-500 text-sm font-medium">Intercepted</p>
                                        <h3 className="text-3xl font-bold text-slate-900 mt-1">18</h3>
                                        <p className="text-xs text-slate-500 font-bold mt-2">1-3 Star Reviews Saved</p>
                                    </div>
                                    <div className="card border-l-4 border-l-blue-500">
                                        <p className="text-slate-500 text-sm font-medium">Total Scans</p>
                                        <h3 className="text-3xl font-bold text-slate-900 mt-1">385</h3>
                                        <p className="text-xs text-blue-600 font-bold mt-2">42% Conversion</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* INBOX TAB */}
                        {tab === 'inbox' && (
                            <div className="fade-in space-y-6">
                                <h1 className="text-2xl font-bold text-slate-900">Intercepted Feedback</h1>
                                <div className="space-y-4">
                                    {INTERCEPTED_DATA.map(item => (
                                        <div key={item.id} className="card hover:border-blue-400 cursor-pointer transition-colors">
                                            <div className="flex justify-between items-start mb-2">
                                                <div className="flex items-center gap-3">
                                                    <div className="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center font-bold text-slate-600">{item.name[0]}</div>
                                                    <span className="font-bold text-slate-900">{item.name}</span>
                                                </div>
                                                <span className="bg-red-100 text-red-600 text-xs font-bold px-2 py-1 rounded">{item.status}</span>
                                            </div>
                                            <div className="text-yellow-400 text-xs mb-3">
                                                {[...Array(5)].map((_,i) => <i key={i} className={i < item.rating ? "fa-solid fa-star" : "fa-regular fa-star text-slate-300"}></i>)}
                                            </div>
                                            <p className="text-slate-600 bg-slate-50 p-3 rounded-lg text-sm mb-3">"{item.feedback}"</p>
                                            <div className="flex justify-between items-center">
                                                <span className="text-xs text-slate-400">{item.date}</span>
                                                <button className="text-sm text-blue-600 font-bold hover:underline">Reply Privately â†’</button>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* QR CODE TAB */}
                        {tab === 'qr' && (
                            <div className="fade-in max-w-lg mx-auto text-center mt-10">
                                <div className="card">
                                    <h2 className="text-xl font-bold text-slate-900">Your Gatekeeper QR</h2>
                                    <p className="text-slate-500 text-sm mb-6">Scan this to test the customer experience.</p>
                                    <div className="flex justify-center mb-6">
                                        <div ref={qrRef} className="p-4 bg-white border-2 border-slate-100 rounded-xl"></div>
                                    </div>
                                    <div className="bg-slate-50 p-3 rounded text-xs text-slate-500 break-all mb-6">
                                        {window.location.href.split('#')[0] + "#feedback"}
                                    </div>
                                    <button onClick={() => window.open(window.location.href.split('#')[0] + "#feedback", '_blank')} className="bg-slate-900 text-white px-6 py-3 rounded-xl font-bold text-sm hover:bg-slate-800 transition-colors">
                                        Open Customer View
                                    </button>
                                </div>
                            </div>
                        )}

                    </main>
                </div>
            );
        };

        // --- ROUTER (The Magic Switch) ---
        const App = () => {
            const [route, setRoute] = useState(window.location.hash);

            useEffect(() => {
                const handleHashChange = () => setRoute(window.location.hash);
                window.addEventListener('hashchange', handleHashChange);
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, []);

            // ROUTING LOGIC
            if (route === '#feedback') return <FeedbackFlow />;
            return <DashboardApp />;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
